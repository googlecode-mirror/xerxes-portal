<?xml version="1.0" encoding="utf-8"?>
<xerxes version="1.1">

	<!-- <commands> define the basic behaviors of the system, mapping actions specified in the URL or from the 
	     command line to command classes that fetch or update data as well as files for displaying the results 
		 of those actions -->
		 
	<commands>
	
		<!-- <default> defines the action to take if no 'base' or 'action' is defined in the request paramaters,
		     this is in effect the home page of the application; must include a <section> and an <action> that 
			 exists in the XML below -->
		
		<default>
			<section>databases</section>
			<action>categories</action>
		</default>

		<!-- <include>s specify files or directories to include in the application; in the case of the latter, 
		     all php files in that directory will be included; you can also specify additional files or directories
			 to include in each <section> or for specific <action>s  -->

		<include>lib/Xerxes/</include>
		
		<!-- <section>s group actions in the system, defining basic attributes for all <action>s within that section; 
		     each of the attributes here can be overriden by the <action>.
			 
			 @name [required] = this corresponds to the 'base' in the request paramaters
			 @directory [required] = must correspond to the directory in the commands folder where the command classes live
			 @namespace [required]= the first part of the command class names, such as 'Xerxes' in Xerxes_Command_Databases
			 @documentElement [required] = the name the document element in the xml response
			 @restricted [optional] = whether this part of the application should be IP restricted to the local campus range, default false
			 @login [optional] = whether the user must be logged in under their username, default false
		 -->
	
		<section name="databases" directory="databases" namespace="Xerxes" documentElement="knowledge_base" restricted="false" login="false">	
			
			<!-- <action>s map specific actions to command classes and views
			
			     @name [required] = this corresponds to 'action' in the request paramaters
				 @directory [optional] = override the location of the command class
				 @namespace [optional] = override the prefix of the command class
				 @restricted [optional] = override ip restriction
				 @documentElement [optional] = override the document element name
				 @login [optional] = override login restriction
				 @cli [optional] = whether action should be limited to command line interface, do not run from web; set value = true	
				
				 <command>s specify the command class to execute, include only the trailing name, such as 'Databases' 
				 	in Xerxes_Command_Databases; can be multiple <command>s, they will be executed in order
				 	
					@directory [optional] = override the location of the command class
				 	@namespace [optional] = override the prefix of the command class
					
				 <request>s are optional, and specify a parameter to include by default in the request
				 	@name = the request paramater attribute, so <request name="foo">bar</request> would be the equivalent
					of '&foo=bar' had it come in from the URL
					
				 <view> specifies the file to use to display the xml generated by the commands, by default will be
				 	an xslt file, but can be a php file, in which case specify the attribute type='php'. value should
					be the path to the view file from the base directory of the instance. leave view empty as <view />
					in the case of a redirect
			 --> 
			
			<action name="categories">
				<command>DatabasesCategories</command>
				<command>DatabasesSubject</command>
				<request name="subject">quick-search</request>
				<view>xsl/databases_categories.xsl</view>
			</action>
			<action name="subject">
				<command>DatabasesSubject</command>
				<pathParamMap>
					<mapEntry pathIndex="2" property="subject"/>
				</pathParamMap>
				<view>xsl/databases_subject.xsl</view>
			</action>
      <action name="subject_embed_gen">
        <command>DatabasesSubject</command>
        <command directory="snippets">SnippetsGenSubject</command>
				<pathParamMap>
					<mapEntry pathIndex="2" property="subject"/>
				</pathParamMap>
        <view>xsl/snippets_gen_subject.xsl</view>
      </action>
			<action name="old-subject">
				<command>DatabasesCategories</command>
				<view type="php">custom/databases_old-subject.php</view>
			</action>
			<action name="metasearch">
				<command>DatabasesSubject</command>
				<view>xsl/databases_metasearch.xsl</view>
			</action>
			<action name="jump">
				<command>DatabasesSubject</command>
				<view type="php">custom/databases_jump.php</view>
			</action>
			<action name="alphabetical">
        <!-- would you like a search box on your A-Z list? If not, remove
             or comment out the next <request> line. -->
        <request name="show_search_box">true</request>
				<command>DatabasesDatabase</command>
      	<view>xsl/databases_alphabetical.xsl</view>
			</action>
      <action name="find">
        <request name="show_alpha_links">false</request>
        <request name="show_search_box">true</request>
        <command>DatabasesDatabase</command>
        <command>DatabasesRedirectOneResult</command>
      	<view>xsl/databases_alphabetical.xsl</view>
      </action>
			<action name="database">
				<command>DatabasesDatabase</command>
				<pathParamMap>
					<mapEntry pathIndex="2" property="id"/>
				</pathParamMap>
				<view>xsl/databases_database.xsl</view>		
			</action>
			<action name="proxy">
				<command>DatabasesProxy</command>
				<view />
			</action>
			<action name="populate" cli="true">
				<command>PopulateDatabases</command>
				<view />
			</action>
		</section>
    
    <section name="embed" directory="embed" namespace="Xerxes" documentElement="xerxes">
      <action name="gen_subject">
        <command directory="databases">DatabasesSubject</command>
        <command>EmbedGenSubject</command>
				<pathParamMap>
					<mapEntry pathIndex="2" property="subject"/>
				</pathParamMap>
        <view type="xsl">xsl/embed/embed_gen_subject.xsl</view>
      </action>
      <action name="subject">
        <command directory="databases">DatabasesSubject</command>
        <pathParamMap>
					<mapEntry pathIndex="2" property="subject"/>
				</pathParamMap>
        <view>xsl/embed/embed_subject.xsl</view>
      </action>
    </section>
    
		<section name="authenticate" directory="authenticate" namespace="Xerxes" documentElement="authenticate">
			<action name="login">
				<command>AuthenticateLogin</command>
				<view>xsl/authenticate_login.xsl</view>
			</action>
			<action name="logout">
				<command>AuthenticateLogout</command>
				<view>xsl/authenticate_logout.xsl</view>
			</action>
			<action name="guest">
				<command>AuthenticateGuest</command>
				<view />
			</action>
			<action name="cas-validate">
				<command>AuthenticateCasValidate</command>
				<view />
			</action>
		</section>
		<section name="folder" directory="folder" namespace="Xerxes" documentElement="folder" restricted="true">	
			<pathParamMap>
				<mapEntry pathIndex="2" property="username"/>
			</pathParamMap>
			<action name="home">
				<command>FolderResults</command>
				<command directory="availability">AvailabilityInjectFullText</command>
				<command>FolderTags</command>
				<command>FolderPaging</command>
				<view>xsl/folder_home.xsl</view>
			</action>
			<action name="full">
        <pathParamMap>
          <mapEntry pathIndex="3" property="record" />
        </pathParamMap>      
				<command>FolderResults</command>
				<view>xsl/folder_full.xsl</view>
			</action>
			<action name="output_email">
				<request name="brief">true</request>
				<command>FolderResults</command>
				<view>xsl/folder_output_email.xsl</view>
			</action>
			<action name="output_export_text">
				<request name="brief">true</request>
				<command>FolderResults</command>
				<view>xsl/folder_output_export_text.xsl</view>
			</action>
			<action name="output_export_endnote">
				<request name="brief">true</request>
				<command>FolderResults</command>
				<view>xsl/folder_output_export_endnote.xsl</view>
			</action>	
			<action name="export">
				<command>FolderResults</command>
				<view type="php">custom/folder_export.php</view>
			</action>
			<action name="email">
				<command>FolderResults</command>
				<command>FolderEmail</command>
				<view type="php">custom/folder_export.php</view>
			</action>
			<action name="delete">
				<command>FolderDelete</command>
				<view />
			</action>
			<action name="tags_edit">
				<command>FolderTagsEdit</command>
				<view>xsl/folder_tags_edit.xsl</view>
			</action>
			<action name="redirect" restricted="false">
				<command>FolderRedirect</command>
				<view />
			</action>
		</section>
    
		<section name="availability" directory="availability" namespace="Xerxes" documentElement="xerxes">

			<!-- fulltext and refereed are depricated in version 1.2 in favor of the 'inject'
			     equivalent commands, which are included now as part of actions in metasearch
			     and folder sections -->
			     
			<action name="fulltext">
				<command>AvailabilityFulltext</command>
				<view />
			</action>
			<action name="refereed">
				<command>AvailabilityRefereed</command>
				<view />
			</action>
			
			<action name="populate" cli="true">
				<command>PopulateFulltext</command>
				<view />
			</action>
		</section>
		<section name="metasearch" directory="metasearch" namespace="Xerxes" documentElement="metasearch" restricted="true">	
			<action name="search">
				<command>MetasearchSearch</command>
				<view />
			</action>
			<action name="hits">
				<command>MetasearchHits</command>
				<view>xsl/metasearch_hits.xsl</view>
			</action>
			<action name="results">
				<command>MetasearchResults</command>
				<command directory="availability">AvailabilityInjectRefereed</command>
				<command directory="availability">AvailabilityInjectFullText</command>
				<command>MetasearchPaging</command>
				<pathParamMap>
					<mapEntry pathIndex="2" property="group"/>
					<mapEntry pathIndex="3" property="resultSet"/>
				</pathParamMap>
				<view>xsl/metasearch_results.xsl</view>
			</action>
			<action name="facet">
				<command>MetasearchFacet</command>
				<command directory="availability">AvailabilityInjectRefereed</command>
				<command directory="availability">AvailabilityInjectFullText</command>
				<command>MetasearchPaging</command>
				<view>xsl/metasearch_results.xsl</view>
			</action>
			<action name="sfx">
				<command>MetasearchSFX</command>
				<view />
			</action>
			<action name="sort">
				<command>MetasearchSort</command>
				<view />
			</action>
			<action name="save-delete">
				<command>MetasearchSaveDelete</command>
				<view>xsl/metasearch_save-delete.xsl</view>
			</action>
			<action name="record">
				<command>MetasearchRecord</command>
				<command directory="availability">AvailabilityInjectRefereed</command>
				<view>xsl/metasearch_record.xsl</view>
			</action>
		</section>
		
	</commands>
</xerxes>
