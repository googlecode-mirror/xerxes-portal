#summary Recipes for Xerxes customizations

=Dual Subject Pages=

Sets up Xerxes so that the metasearch component is not as prominent.  When a user clicks on a category from the home page, the initial subject page that he or she sees is just a listing of databases, with a link to a separate page where they can search.

Examples:
 
 * [http://library.csun.edu/xerxes/ Cal State Northridge]
 * [http://xerxes.calstate.edu/pomona/ Cal Poly Pomona]
 * [http://xerxes.calstate.edu/sonoma/ Sonoma State University]


== For version 1.5==

  # Copy databases_subject.xsl from your lib/xsl directory into `demo/xsl`.
  # Rename that local copy to `databases_metasearch.xsl`.
  # [http://xerxes-portal.googlecode.com/svn/cookbook/dual-subject-pages/databases_subject.xsl Download this file] into your `demo/xsl`directory. That file is a bare-bones example of a non-metasearch subject page.  You'll certainly want to edit it and add some CSS to make it look better.

== For version 1.6 or higher==

  # [http://xerxes-portal.googlecode.com/svn/cookbook/dual-subject-pages/databases_subject_nosearch.xsl Download this file] into your `demo/xsl` directory.
  # Set-up you local [http://xerxes-portal.googlecode.com/svn/cookbook/dual-subject-pages/actions.xml actions.xml like this].

== Upgrading from 1.5 method to 1.6 method==

  # Delete your local copy of `databases_metasearch.xsl`.
  # Rename `databases_subject.xsl` to `databases_subject_nosearch.xsl`.
  # Set-up your local `actions.xml` as above.

=External Search Box=
Xerxes comes with a feature for [Embed dynamically embedding the search box], and optionally the databases, in external pages.  But if you need more control, here's the HTML and search syntax:

{{{
<form method="get" action="http://xerxes.example.com/demo">
  <input type="hidden" name="base" value="metasearch" />
  <input type="hidden" name="action" value="search" />

  <input type="hidden" name="context" value="Your Name for the Search" />
        
  <input type="hidden" name="context_url" value="http://library.example.com/" />

  <input name="query" type="text" />
  <input type="submit" name="Submit" value="GO" />

  <input name="database" value="CAL01039" type="hidden" />
</form>
}}}

`context` is the name you are giving this grouping of databases -- typically a subject or name like 'Quick Search'.  This will appear in the Xerxes search results pages themselves, in the page header and the breadcrumbs.

`context_url` is the URL of the (external) page you are embedded this search box.  Together with the name given in `context`, Xerxes will use this to construct breadcrumbs back to this page.  For added security, you may also limit this to [Configuration#limit_context_url allowed domains] in config.xml.

You can include as many `database` inputs as you like, up to the search limit set in Metalib.  Do *not* put brackets `[]` at the end of the name, a PHP workaround that Xerxes does not recognize.

Here is the resulting URL:

{{{
http://xerxes.example.com/demo?
  base=metasearch
  &action=search
  &context=Your+Name+for+the+Search
  &context_url=http%3A%2F%2Flibrary.example.com%2F
  &query=xml&database=CAL01039
}}}

=Catalog links=

To have Xerxes show a link to holdings for your catalog search results, you can simply enter the link syntax in the `Link to Holdings in Native Interface` field of the IRD in Metalib.  

However, that syntax assumes that you will use a single field from the MARC record (usually one containing the bibliographic ID number of the record) to construct the link.  Some systems, such as Innovative, however, don't expose a bibliographic ID number in their Z39.50 response, so no single linking syntax will work.

In these cases, you have the option of constructing a more complex linking syntax (based on a variety of fields) using the `additional_record_links` template in Xerxes.  

Xerxes will call this template for _every_ record, so you need to first test for the Metalib ID of your catalog (in the example below it is `CAL13702`), and then create the link using data from the record.

Here's an example for Innovative systems that works pretty well:

{{{

<xsl:template name="additional_record_links">
	
	<xsl:if test="metalib_id = 'CAL13702'">
		
		<xsl:variable name="catalog_link">
			<xsl:text>http://opac.csuchico.edu/search/</xsl:text>
			<xsl:choose>
				<xsl:when test="standard_numbers/oclc">
					<xsl:text>o</xsl:text>
					<xsl:value-of select="standard_numbers/oclc" />
				</xsl:when>
				<xsl:when test="standard_numbers/isbn">
					<xsl:text>i</xsl:text>
					<xsl:value-of select="standard_numbers/isbn" />
				</xsl:when>
					<xsl:when test="standard_numbers/issn">
					<xsl:text>i</xsl:text>
					<xsl:value-of select="standard_numbers/issn" />
				</xsl:when>
				<xsl:otherwise>
					<xsl:text>t</xsl:text>
					<xsl:value-of select="php:function('urlencode', string(title_normalized))" />
				</xsl:otherwise>
			</xsl:choose>
		</xsl:variable>
		
		<div class="recordAction textLink">
			<a href="{$catalog_link}">
				<img src="images/book.gif" width="16" height="16" alt="" border="0" />
				<xsl:text> </xsl:text>
				Check availability in catalog
			</a>
		</div>
	
	</xsl:if>
	
</xsl:template>




}}}